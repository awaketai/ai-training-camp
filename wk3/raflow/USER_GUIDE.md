# RAFlow 用户指南

欢迎使用 RAFlow - 实时语音转写系统！本指南将帮助你快速上手并充分利用 RAFlow 的各项功能。

## 目录

- [快速开始](#快速开始)
- [系统要求](#系统要求)
- [安装](#安装)
- [首次设置](#首次设置)
- [基础功能](#基础功能)
- [高级功能](#高级功能)
- [常见问题](#常见问题)
- [故障排查](#故障排查)

---

## 快速开始

RAFlow 是一个基于 ElevenLabs Scribe v2 API 的实时语音转写工具，可以将你的语音实时转换为文字并自动输入到任何应用程序中。

### 核心特性

- ⚡️ **实时转写**: 延迟低于 500ms
- 🎯 **智能注入**: 自动选择最佳文本输入方式
- 📊 **性能监控**: 实时查看系统运行状态
- 🔒 **隐私保护**: 仅在激活时采集音频
- 🎨 **简洁界面**: 直观易用的用户界面

---

## 系统要求

### 最低配置

- **操作系统**: macOS 11.0 (Big Sur) 或更高版本
- **处理器**: Apple Silicon (M1/M2/M3) 或 Intel Core i5
- **内存**: 4GB RAM
- **存储**: 100MB 可用空间
- **网络**: 稳定的互联网连接

### 推荐配置

- **操作系统**: macOS 13.0 (Ventura) 或更高版本
- **处理器**: Apple Silicon (M1 或更高)
- **内存**: 8GB RAM
- **网络**: 宽带连接（上行 1Mbps+）

### 其他要求

- **ElevenLabs API Key**: 需要有效的 API 密钥
- **麦克风**: 内置或外接麦克风
- **权限**: 麦克风访问权限 + 辅助功能权限

---

## 安装

### 下载

1. 访问 [GitHub Releases](https://github.com/YOUR_USERNAME/raflow/releases)
2. 下载最新版本的 `RAFlow_x.y.z_universal.dmg`

### 安装步骤

1. **打开 DMG 文件**
   - 双击下载的 `.dmg` 文件

2. **拖动到 Applications**
   - 将 RAFlow 图标拖到 Applications 文件夹

3. **首次运行**
   - 打开 Applications 文件夹
   - 找到 RAFlow
   - **重要**: 按住 Control 键点击 RAFlow 图标
   - 选择"打开"
   - 在弹出的对话框中点击"打开"

> **为什么需要 Control+点击？**
>
> macOS 的 Gatekeeper 功能会阻止首次运行从互联网下载的应用。使用 Control+点击可以绕过这个限制。之后可以正常双击打开。

### 卸载

如需卸载 RAFlow：

1. 退出 RAFlow（从托盘菜单选择"退出"）
2. 将 Applications 文件夹中的 RAFlow 拖到废纸篓
3. 清空废纸篓

---

## 首次设置

### 1. 启动应用

首次运行 RAFlow 时，会显示权限设置向导。

### 2. 配置权限

RAFlow 需要两个系统权限才能正常工作：

#### 2.1 麦克风权限

**用途**: 采集音频进行转写

**设置步骤**:
1. 点击"权限"标签页
2. 在"麦克风访问"部分，点击"请求权限"
3. 在系统弹窗中点击"确定"

如果权限被拒绝：
1. 打开"系统偏好设置" > "安全性与隐私" > "隐私"
2. 选择"麦克风"
3. 勾选 RAFlow

#### 2.2 辅助功能权限

**用途**: 将转写文本输入到其他应用

**设置步骤**:
1. 在"辅助功能访问"部分，点击"请求权限"
2. 系统会自动打开设置页面
3. 点击左下角的锁图标，输入密码
4. 在列表中找到 RAFlow，勾选它
5. 返回 RAFlow，刷新状态

### 3. 配置 API Key

1. 点击"转写设置"标签页
2. 访问 [ElevenLabs Dashboard](https://elevenlabs.io/app/settings/api-keys)
3. 复制你的 API Key
4. 粘贴到 RAFlow 的"API 密钥"输入框
5. 点击"保存"

> **API Key 存储**
>
> API Key 会安全地存储在 macOS 钥匙串中，不会被明文保存。

### 4. 选择音频设备

1. 在"音频设备"下拉菜单中选择麦克风
2. 推荐使用：
   - 外接麦克风（音质更好）
   - 内置麦克风（便携性好）

### 5. 开始转写

点击"开始转写"按钮，开始你的第一次语音转写！

---

## 基础功能

### 1. 实时语音转写

#### 启动转写

1. 点击"开始转写"按钮
2. 对着麦克风说话
3. 实时文字会显示在转写界面

#### 转写界面说明

- **音频波形**: 显示实时音频输入强度
- **转写文本**: 显示实时和最终转写结果
- **说话状态**: 显示是否检测到语音

#### 停止转写

点击"停止录音"按钮即可停止。

### 2. 文本注入

转写的文字可以自动输入到任何应用程序中。

#### 使用方法

1. 确保已授予辅助功能权限
2. 打开你想输入文字的应用（如 Chrome、Notes、TextEdit）
3. 点击输入框，确保光标在正确位置
4. 在 RAFlow 中点击"文本注入"标签页
5. 输入测试文本
6. 点击"注入文本"按钮

#### 自动策略选择

RAFlow 会根据目标应用自动选择最佳输入方式：

- **键盘模拟**: 用于终端、IDE 等应用
  - 优点：兼容性好，不影响剪贴板
  - 缺点：对长文本较慢

- **剪贴板注入**: 用于浏览器、文本编辑器等
  - 优点：快速，支持长文本
  - 缺点：会临时修改剪贴板

#### 支持的应用

已测试的应用：

✅ Chrome/Safari/Firefox
✅ TextEdit/Pages/Word
✅ Notes
✅ Terminal/iTerm2
✅ VS Code
✅ Slack/Discord
✅ Notion

### 3. 性能监控

查看系统运行状态和性能指标。

#### 查看方式

1. 点击"性能监控"标签页
2. 查看各项指标

#### 主要指标

**音频处理**
- 处理的数据包
- 丢弃的数据包
- 丢包率
- 平均处理时间

**网络通信**
- 发送/接收消息数
- 发送/接收数据量
- 重连次数

**转写性能**
- 部分/完整转写数
- 转写延迟

**系统资源**
- 内存使用
- CPU 使用
- 错误统计

#### 健康状态

- **绿色**: 系统运行正常
- **红色**: 出现性能问题

当出现红色状态时，会显示优化建议。

---

## 高级功能

### 快捷键（计划中）

未来版本将支持全局快捷键：

- `⌘ + Shift + Space`: 开始/停止转写
- `⌘ + Shift + I`: 注入最后的转写结果

### 自定义设置（计划中）

未来版本将支持：

- VAD 灵敏度调整
- 音频质量设置
- 注入策略自定义
- 主题切换

---

## 常见问题

### Q: RAFlow 支持哪些语言？

A: RAFlow 使用 ElevenLabs Scribe v2 API，支持多种语言。具体支持的语言请查看 [ElevenLabs 文档](https://elevenlabs.io/docs)。

### Q: 转写准确度如何？

A: 准确度取决于：
- 麦克风质量
- 说话清晰度
- 环境噪音
- 网络状况

推荐使用外接麦克风并在安静环境中使用。

### Q: 会消耗多少流量？

A: 音频以 16kHz PCM 格式发送，约为：
- 每分钟约 2MB
- 一小时约 120MB

### Q: API Key 如何计费？

A: 请查看 [ElevenLabs 定价页面](https://elevenlabs.io/pricing)了解详情。

### Q: 可以离线使用吗？

A: 不可以。RAFlow 需要网络连接到 ElevenLabs API 进行转写。

### Q: 支持 Windows 或 Linux 吗？

A: 目前仅支持 macOS。Windows 和 Linux 支持在计划中。

### Q: 转写结果可以编辑吗？

A: 当前版本显示的是实时转写结果，无法直接编辑。建议将文本注入到目标应用后再编辑。

---

## 故障排查

### 应用无法启动

**症状**: 双击应用后没有反应

**解决方案**:
1. 使用 Control+右键点击 > "打开"
2. 检查 Console.app 中的错误日志
3. 确保 macOS 版本 ≥ 11.0

### 权限请求失败

**症状**: 点击"请求权限"后无反应

**解决方案**:
1. 手动打开"系统偏好设置"
2. 导航到"安全性与隐私" > "隐私"
3. 手动添加 RAFlow

### 麦克风无法采集

**症状**: 音频波形无反应

**解决方案**:
1. 检查麦克风是否正常工作（系统偏好设置 > 声音）
2. 确认 RAFlow 有麦克风权限
3. 尝试重新选择音频设备
4. 重启应用

### WebSocket 连接失败

**症状**: 显示"连接错误"

**解决方案**:
1. 检查网络连接
2. 验证 API Key 是否正确
3. 检查 ElevenLabs 服务状态
4. 检查防火墙设置

### 文本注入失败

**症状**: 点击"注入文本"后目标应用无反应

**解决方案**:
1. 确认有辅助功能权限
2. 确保目标应用的输入框已激活
3. 尝试重启目标应用
4. 检查目标应用是否在支持列表中

### 转写延迟高

**症状**: 转写结果延迟 > 1秒

**解决方案**:
1. 检查网络质量（上行带宽）
2. 关闭其他占用网络的应用
3. 查看性能监控页面的延迟指标
4. 尝试重启 RAFlow

### 高 CPU/内存占用

**症状**: 系统变慢，风扇转速高

**解决方案**:
1. 查看性能监控页面
2. 检查是否有音频数据包堆积
3. 重启应用释放资源
4. 更新到最新版本

### 应用崩溃

**症状**: 应用意外退出

**解决方案**:
1. 查看崩溃报告：
   ```
   ~/Library/Logs/DiagnosticReports/RAFlow*.crash
   ```
2. 记录崩溃前的操作
3. 在 GitHub 提交 Issue
4. 尝试重新安装

---

## 获取帮助

### 文档

- [README](README.md) - 项目介绍
- [RELEASE](RELEASE.md) - 发布流程
- [CHANGELOG](CHANGELOG.md) - 版本历史

### 社区

- **GitHub Issues**: 报告 Bug 或请求功能
- **GitHub Discussions**: 社区讨论
- **邮件**: support@raflow.dev

### 贡献

RAFlow 是开源项目，欢迎贡献！

1. Fork 项目
2. 创建功能分支
3. 提交变更
4. 发起 Pull Request

查看 [CONTRIBUTING.md](CONTRIBUTING.md) 了解详情。

---

## 隐私政策

### 数据收集

RAFlow 仅在你主动开始转写时采集音频：

- ✅ 音频数据实时发送到 ElevenLabs API
- ✅ API Key 存储在本地钥匙串
- ✅ 性能指标仅本地统计
- ❌ 不会收集任何个人信息
- ❌ 不会后台录音
- ❌ 不会上传音频文件

### 数据安全

- API Key 加密存储
- 音频通过 HTTPS 加密传输
- 不保存音频到本地
- 转写结果不会上传

---

## 许可证

RAFlow 使用 MIT 许可证。查看 [LICENSE](LICENSE) 文件了解详情。

---

## 致谢

RAFlow 使用以下开源项目：

- [Tauri](https://tauri.app/) - 跨平台桌面应用框架
- [React](https://react.dev/) - UI 框架
- [cpal](https://github.com/RustAudio/cpal) - 音频采集
- [rubato](https://github.com/HEnquist/rubato) - 音频重采样
- [ElevenLabs Scribe v2](https://elevenlabs.io/) - 语音转写 API

---

**版本**: 1.0.0
**最后更新**: 2025-12-22
**维护者**: RAFlow Team

感谢使用 RAFlow！如有问题，欢迎联系我们。
